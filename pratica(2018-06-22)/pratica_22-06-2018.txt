
--TAREFA A:

CREATE USER brunoolliver141 IDENTIFIED BY 703897 DEFAULT TABLESPACE USERS TEMPORARY TABLESPACE TEMP QUOTA 100M ON USERS;
GRANT ALUNO TO brunoolliver141;

--EFETUA NOVA CONEXAO COM BRUNOOLLIVER141

CREATE TABLE CLIENTE (
    CODIGO INTEGER PRIMARY KEY,
    NOME CHAR(40) NOT NULL
);

GRANT INSERT, SELECT, UPDATE ON CLIENTE TO brunoolliver141;


INSERT INTO CLIENTE VALUES(1,'NEYMAR');
INSERT INTO CLIENTE VALUES(2,'COUTINHO');
INSERT INTO CLIENTE VALUES(3,'MARCELO');
INSERT INTO CLIENTE VALUES(4,'ALISSON');
INSERT INTO CLIENTE VALUES(5,'GABRIEL JESUS');
INSERT INTO CLIENTE VALUES(6,'ROBERTO FIRMINO');
INSERT INTO CLIENTE VALUES(7,'FREDERICO');
INSERT INTO CLIENTE VALUES(8,'DOUGLAS COSTA');
INSERT INTO CLIENTE VALUES(9,'DANILO SILVA');
INSERT INTO CLIENTE VALUES(10,'FERNANDINHO');
INSERT INTO CLIENTE VALUES(11,'TAISON');

SELECT * FROM CLIENTE;

UPDATE CLIENTE SET NOME = 'CASSIO RAMOS'
WHERE  CODIGO = 4;

DELETE FROM CLIENTE
WHERE NOME = 'NEYMAR';

--NAO EH PERMITIDO  DELETER, GERANDO ERRO DE EXECUCAO
-----------------------------------------------------------------------
--TAREFA B:

CREATE TABLE ITENS (
    CODIGO INTEGER PRIMARY KEY,
    ITEM CHAR(50) NOT NULL
);

CREATE ROLE CAIXA;
GRANT INSERT, SELECT ON ITENS TO CAIXA;

CREATE ROLE GERENTE;
GRANT SELECT, UPDATE, DELETE ON ITENS TO GERENTE;

CREATE USER MARIA IDENTIFIED BY 123;
GRANT CAIXA TO MARIA;

CREATE USER JOAO IDENTIFIED BY 123;
GRANT CAIXA TO  JOAO;

CREATE USER JOSE IDENTIFIED BY 123;
GRANT GERENTE TO  JOSE;

--EFETUA CONEXAO COM USUARIO JOAO
INSERT INTO ITENS VALUES (1,'SABAO EM BARRA');
INSERT INTO ITENS VALUES (2,'SABONETE');
INSERT INTO ITENS VALUES (3,'DETTERGENTE');
INSERT INTO ITENS VALUES (4,'SABAO EM PO');

SELECT * FROM ITENS;

UPDATE ITENS SET NOME = 'DETERGENTE' WHERE CODIGO = 3;

-- SELECT E UPDATE NAO SAO PERMITIDOS, ERRO DE EXECUCAO
-----------------------------------------------------------------------
-- TAREFA C:
-- EFETUA CONEXAO COM USUARIO BRUNOOLLIVER14
CREATE TABLE REGISTRO (
    CODIGO INTEGER PRIMARY KEY,
    USUARIO CHAR(40) NOT NULL
);

CREATE VIEW VREGISTRO AS
    SELECT CODIGO,USUARIO
    FROM REGISTRO
    WHERE USUÁRIO = USER;

INSERT INTO REGISTRO VALUES(1,'BRUNOOLLIVER141');
INSERT INTO REGISTRO VALUES(2,'JOAO');

GRANT VIEW, SELECT,INSERT, DELETE,UPDATE ON VREGISTRO TO BRUNOOLLIVER141;

--EFETUA CONEXAO COM USUARIO BRUNOOLLIVER141

SELECT * FROM VREGISTRO;
DELETE FROM VREGISTRO
WHERE  USUARIO = 'JOAO';

--ATRAVÉS DA VIEW E POSSIVEL O USUARIO DELETAR REGISTROS MESMO NAO POSSUINDO PERMISSAO DE ACESSO A TABELA PRINCIPAL.






